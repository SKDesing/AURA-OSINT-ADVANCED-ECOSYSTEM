# 🚨 VULNERABILITY INVENTORY - AURA OSINT

**Date**: $(date -u +"%Y-%m-%d %H:%M:%S UTC")
**Status**: 🔴 CRITICAL - 10 vulnérabilités détectées

## 📊 RÉSUMÉ

- **HIGH**: 5 vulnérabilités
- **MODERATE**: 5 vulnérabilités
- **CRITICAL**: 0 vulnérabilités

## 🔴 HIGH SEVERITY (5)

### 1. nth-check - Inefficient Regular Expression Complexity
- **Package**: nth-check
- **Versions**: <2.0.1
- **Path**: clients__web-react>react-scripts>@svgr/webpack>@svgr/plugin-svgo>svgo>css-select>nth-check
- **Fix**: Upgrade to >=2.0.1
- **Impact**: DoS via ReDoS

### 2. ws - DoS when handling requests with many HTTP headers
- **Package**: ws
- **Versions**: >=8.0.0 <8.17.1
- **Path**: live-tracker>puppeteer-stream>puppeteer-core>ws
- **Fix**: Upgrade to >=8.17.1
- **Impact**: Denial of Service

### 3. tar-fs - Extract outside specified dir
- **Package**: tar-fs
- **Versions**: >=2.0.0 <2.1.3
- **Path**: .>@xenova/transformers>sharp>prebuild-install>tar-fs
- **Fix**: Upgrade to >=2.1.3
- **Impact**: Path traversal

### 4. tar-fs - Symlink validation bypass
- **Package**: tar-fs
- **Versions**: >=2.0.0 <2.1.4
- **Path**: .>@xenova/transformers>sharp>prebuild-install>tar-fs
- **Fix**: Upgrade to >=2.1.4
- **Impact**: Path traversal

### 5. tar-fs - Link Following and Path Traversal
- **Package**: tar-fs
- **Versions**: >=2.0.0 <2.1.2
- **Path**: .>@xenova/transformers>sharp>prebuild-install>tar-fs
- **Fix**: Upgrade to >=2.1.2
- **Impact**: Path traversal

## 🟡 MODERATE SEVERITY (5)

### 1. PostCSS - Line return parsing error
- **Package**: postcss
- **Versions**: <8.4.31
- **Path**: clients__web-react>react-scripts>resolve-url-loader>postcss
- **Fix**: Upgrade to >=8.4.31

### 2. webpack-dev-server - Source code theft (non-Chromium)
- **Package**: webpack-dev-server
- **Versions**: <=5.2.0
- **Path**: clients__web-react>react-scripts>webpack-dev-server
- **Fix**: Upgrade to >=5.2.1

### 3. webpack-dev-server - Source code theft (general)
- **Package**: webpack-dev-server
- **Versions**: <=5.2.0
- **Path**: clients__web-react>react-scripts>webpack-dev-server
- **Fix**: Upgrade to >=5.2.1

### 4. nodemailer - Email to unintended domain
- **Package**: nodemailer
- **Versions**: <7.0.7
- **Path**: backend/node_modules/nodemailer
- **Fix**: Upgrade to >=7.0.7

### 5. smtp-server - Depends on vulnerable nodemailer
- **Package**: smtp-server
- **Versions**: 2.0.0 - 3.14.0
- **Path**: backend/node_modules/smtp-server
- **Fix**: Update nodemailer dependency

## 🛠️ PLAN DE CORRECTION

### Phase 1 - URGENT (HIGH)
```bash
# 1. Forcer les overrides PNPM
pnpm.overrides:
  "nth-check": ">=2.0.1"
  "ws": ">=8.17.1"
  "tar-fs": ">=2.1.4"

# 2. Backend
cd backend
npm audit fix --force
npm update nodemailer
```

### Phase 2 - MODERATE
```bash
# 1. React Scripts
pnpm.overrides:
  "postcss": ">=8.4.31"
  "webpack-dev-server": ">=5.2.1"

# 2. Rebuild
pnpm install
```

### Phase 3 - VALIDATION
```bash
pnpm audit --prod
npm audit --audit-level moderate
```

## 🎯 ACTIONS IMMÉDIATES

- [ ] Appliquer les overrides PNPM
- [ ] Mettre à jour nodemailer/smtp-server
- [ ] Rebuild complet
- [ ] Validation audit clean
- [ ] Commit des corrections

**DEADLINE**: 24h maximum